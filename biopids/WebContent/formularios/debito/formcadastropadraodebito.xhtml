<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.prime.com.tr/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core">

<ui:composition
	template="/templates/common/paineis/painelsembotoes.xhtml">
	<ui:param name="combos" value="#{mBean.comboModel}" />

	<ui:define name="formularioCadastro">
		<h:panelGrid
			style="margin-right:auto; margin-left: auto; text-align: left;"
			columns="1" rendered="#{mBean.panelEscolha}">
			<h:outputText style="font-weight: bold;"
				value="#{msg.selecioneTipoRegistro}" />
			<h:commandLink value="Pessoa Física"
				action="#{mBean.movePanelFisico}" />
			<h:commandLink value="Pessoa Jurídica"
				action="#{mBean.movePanelJuridico}" />
		</h:panelGrid>

		<h:panelGrid
			style="margin-left:auto; margin-right:auto; text-align:left;"
			columns="1" rendered="#{mBean.panelCadastroTipo}">

			<p:panel style="whith:80%">


				<h:panelGrid style=" margin-right:auto; text-align:left;"
					columns="3">

					<h:panelGrid rendered="#{mBean.panelCpf}" columns="3"
						style="text-align:left;">
						<h:outputText value="#{msg.cpf}" />
						<p:inputMask style="#{styleRequired}" size="15" id="cpf"
							value="#{model.cpf}" mask="999.999.999-99" required="false"
							requiredMessage="#{msg.obr}">
							<p:ajax event="blur"
								oncomplete="showDialog('cpf','devedor', opcao);"
								listener="#{mBean.findDevedor(mBean.objectModel.cpf)}"
								update="contentPanel, dialogOpcao, mensagem" />
						</p:inputMask>
						<p:message for="cpf" display="text" />
					</h:panelGrid>

					<h:panelGrid rendered="#{mBean.panelCnpj}" columns="3"
						style="text-align:left;">
						<h:outputText value="#{msg.cnpj}" />
						<p:inputMask style="#{styleRequired}" size="19" id="cnpj"
							value="#{model.cnpj}" mask="99.999.999/9999-99" required="false"
							requiredMessage="#{msg.obr}">
							<p:ajax event="blur"
								oncomplete="showDialog('cnpj','devedor', opcao);"
								listener="#{mBean.findDevedor(mBean.objectModel.cnpj)}"
								update="contentPanel, dialogOpcao, mensagem" />
						</p:inputMask>
						<p:message for="cnpj" display="text" />
					</h:panelGrid>

					<h:panelGrid columns="3">
						<h:outputText value="#{msg.devedor}" />
						<p:inputText disabled="#{mBean.disableDevedor}"
							style="#{styleRequired}" size="40" id="devedor"
							value="#{model.devedor}" required="true"
							requiredMessage="#{msg.obr}" />
						<p:message for="devedor" display="text" />
					</h:panelGrid>

					<p:commandButton image="ui-icon ui-icon-plusthick" rendered="false"
						action="#{mBean.addDevedor}" onkeypress="captureEvents(arg1)"
						immediate="true" />
					<p:commandLink update="contentPanel" immediate="true" action="#{mBean.addDevedor}">
						<h:graphicImage url="/imagens/plus.PNG" />
					</p:commandLink>
				</h:panelGrid>

				<h:panelGrid style="margin-right:auto; text-align:left;" columns="3">
					<h:outputText value="#{msg.filiado} " />
					<h:selectOneMenu style="#{styleRequired}" id="filiado" readonly="#{mBean.readOnly}" disabled="#{mBean.readOnly}"
						value="#{model.filiado}" required="true" 
						requiredMessage="#{msg.obr}">
						<f:selectItem itemLabel="#{msg.selecione}" itemValue=""
							noSelectionOption="true" />
						<f:selectItems value="#{combos.filiados}" var="object"
							itemLabel="#{object.nome}" itemValue="#{object.codigo}" />
					</h:selectOneMenu>
					<p:message for="filiado" display="text" />
				</h:panelGrid>

				<ui:insert name="debito" />

				<h:panelGrid style=" margin-right:auto; text-align:left;"
					columns="6">

					<h:outputText value="#{msg.dataCompra} " />
					<p:inputMask size="10" required="false" value="#{model.dataCompra}"
						id="dataCompra" requiredMessage="#{msg.obr}" mask="99/99/9999" >
						<p:ajax event="blur"
							listener="#{mBean.validate('DateValidatorNotObr', model.dataCompra, 'dataCompra')}"
							update="mensagem, dataCompra" oncomplete="setFocus('dataVencimento');" ></p:ajax>
					</p:inputMask>
					<p:message for="dataCompra" display="text" />

					<h:outputText value="#{msg.vencimento} " />
					<p:inputMask style="#{styleRequired}" size="10" required="true"
						value="#{model.dataVencimento}" id="dataVencimento"
						requiredMessage="#{msg.obr}" mask="99/99/9999" >
						<p:ajax event="blur"
							listener="#{mBean.validate('DateValidator', model.dataVencimento, 'dataVencimento')}"
							update="mensagem, dataVencimento" oncomplete="setFocus('valor');"></p:ajax>
					</p:inputMask>
					<p:message for="dataVencimento" display="text" />

					<h:outputLabel for="valor" value="#{msg.valor}" />
					<p:inputText style="#{styleRequired}" size="10" id="valor"
						onkeyup="moeda(this);" value="#{mBean.objectModel.valor}"
						required="true" requiredMessage="#{msg.obr}" />
					<p:message for="valor" display="text" />

					<h:outputLabel for="parcela" value="#{msg.nReplicas} " />
					<p:inputText style="#{styleRequired}" size="1" id="parcela"
						onkeyup="numberOnly(this);" value="#{mBean.objectModel.parcela}"
						required="true" requiredMessage="#{msg.obr}" />
					<p:message for="parcela" display="text" />

					<p:commandButton style="width: 100px; height: 40px;"
						value="#{msg.gerarParcela}" id="gerarParcela"
						action="#{mBean.generateParcels}" update="contentPanel, mensagem" />

				</h:panelGrid>
			</p:panel>

		</h:panelGrid>

		<h:panelGrid
			style="margin-left:auto; margin-right:auto; text-align:left;"
			columns="1" rendered="#{mBean.panelParcela}" >

			<p:dataTable var="parcelas" value="#{mBean.debitos}" paginator="true" rows="10"
			paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
			rowsPerPageTemplate="5,10,15">
				<p:column>
					<f:facet name="header">  
                    #{msg.devedor}
            </f:facet>
					<h:outputText value="#{parcelas.pessoa.nome}" />
				</p:column>
				<p:column>
					<f:facet name="header">  
                   #{msg.valor}
            </f:facet>
					<h:outputText value="#{parcelas.valor}">
						<f:convertNumber pattern="R$ #,##0.00"/>
					</h:outputText>
				</p:column>

				<p:column>
					<f:facet name="header">  
                   #{msg.dataVencimento}
            </f:facet>
					<p:calendar pattern="dd/MM/yyyy" value="#{parcelas.dataVencimento}"
						size="10" />
				</p:column>

				<p:column>
					<f:facet name="header">  
                   #{msg.excluirDebito}
            </f:facet>
					<p:commandButton value="#{msg.excluir}" update="contentPanel"
						immediate="true" action="#{mBean.removeParcel(parcelas)}"
						oncomplete="opcao.show()" />
				</p:column>



			</p:dataTable>
			<h:panelGrid style="margin-left:auto; margin-right:auto;">
				<h:inputHidden id="actionOption" value="#{mBean.option}" />
				<p:commandButton  
				style="width: 100px; height: 40px;" value="#{msg.salvar}" id="save"
				action="#{mBean.saveAction}" update="contentPanel, mensagem" oncomplete="showDialog2(opcao)"/>
				
			</h:panelGrid>
		</h:panelGrid>


	</ui:define>

</ui:composition>
</html>